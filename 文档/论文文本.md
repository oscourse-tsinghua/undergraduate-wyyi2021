# t车载网信誉评估的设计与实现

[toc]

需要完善补充的地方：

- 1.1研究背景的后两段，区块链部分添加参考文献
- 1.2.1相关工作区块链部分
- 1.3丰富一下
- 2.1.2画一张示意图
- 3.1运行环境还没写
- 3.3直接讲geohash存储，相关背景（lwq的工作）在哪里补充？
- 3.5丰富一下

## 1 绪论

### 1.1 研究背景

交通是人类社会进步过程中不可缺少的一环。随着交通系统基础设施的逐步完善，人们在依赖便捷交通的同时也产生了更多的需求；面对出行安全、道路规划、环境污染等诸多潜在问题，智能交通系统的概念诞生了，旨在将基础设施与先进的信息技术结合，利用交通环境中产生的大量信息进行数字化、智能化的管理。

车载自组网（VANET，vehicle ad-hoc networks）正是智能交通系统框架中的重要概念之一。车载自组网是专门为车辆间通信而设计的自组织网络，其基本思想是在一定通信范围内的车辆可以共享自己的地理位置、行驶状态以及车载传感器感知的数据，并自发地连接建立起一个移动的网络。通过这些数据的传递，可以实现路况查询、事故预警等功能，从而提高人们的出行体验和整体的交通效率。

然而，考虑到车载自组网通信对象陌生、时空特性变化快的特点，相互通信的邻近车辆不一定是完全可信的，特别是当道路上存在意图在车载网中进行恶意攻击的车辆时，很可能会导致更加严重的安全问题。因此，如何对接入网络的车辆进行科学的可信度评估，成为了保障车载网安全性的一个重要问题。对所有车辆进行公开的信誉评估，可以使车辆在网络通信的过程中自行决定是否信任对方提供的信息，从而在系统层面上确保交通状况能得到真实、准确的反映，并且行驶车辆能够及时地接收到这些信息。

区块链技术起源于比特币，本质上是一种分布式的共享账本和数据库，具有去中心化、不可篡改、可追溯、集体维护、公开透明、时序性强等特点。对于没有网络中心、流动性强的车载网来说，区块链技术的应用可以很好地提供一个车辆间协作的便捷途径，为位置验证、消息传递等功能提供安全性的保障。

基于车载网上车辆的交互信息，设计一套评估车辆信誉的算法，并基于区块链技术实现一套车载网络中的车辆信誉评估系统，与车辆的位置验证、消息传播等应用活动进行结合。

### 1.2 相关工作

#### 1.2.1 区块链技术/去中心化的车载网

单纯介绍区块链技术，或者直接介绍基于区块链的车载网

#### 1.2.2 车辆位置验证

位置验证是证明一个人在某个时间处于某个确定的地理位置的一个数字签名[1]。车载自组网中要求车辆提供具有时效性、准确性的位置验证，以便于更多的车辆行驶信息能有效地应用于更多基于位置的服务（ Location-Based Service，LBS）。

目前，多数车辆位置验证采用的是依赖于网络基础架构的集中式验证，主要通过无线接入点和蜂巢网络为用户提供位置验证。[2-3]这种验证方式在服务器上统一存储用户提交的位置验证申请，以及对其进行确认所需的信息。然而考虑到车载网的流动性，集中式验证往往难以满足车辆对于实时性的要求；同时，作为绝对权威的中心服务器一旦遭受攻击，所有接入网络的车辆都将面临严重的安全问题。

不依赖网络基础架构的验证方式通常利用邻近车辆或车上的移动设备获取有效的位置验证。该验证方式要求参与设备具有一定的短距离通信功能（比如蓝牙）[4]，通过带有私钥签名的点对点传输完成验证，并在互联网中传播验证结果；特别地，对于分布式的位置验证系统，传播后的位置验证结果被写入区块链中[1]。

#### 1.2.3 车辆消息传播

消息传播的实际场景（路况，事故告警）

消息传播的途径（手机应用，车载系统）

#### 1.2.4 车载网信誉管理系统

中心化的车辆信誉管理系统通常使用一个服务器作为完全可信的权威机构，车辆之间的反馈被统一提交并在服务器上进行信誉的计算[5]；这种利用单一中心节点的方式随着智能交通系统的快速发展，已经很难承担起大量车辆对低延迟数据获取的需求。对于去中心化的信誉管理系统，信誉计算的压力被分配到了车载网中的各个节点上，通常在各车辆[6]或是路侧单元（Roadside Unit，RSU）[7]内部执行；但是在本地计算的信誉值很难保证可靠性，同时由于RSU作为分布在室外的基础设施，比较容易受到攻击和损害。[8]提出了一种基于区块链技术的去中心化车辆信誉管理方式，利用RSU进行数据处理和信誉维护，并通过区块链结构保证数据的同步和安全性，降低单个RSU故障对系统带来的影响；同时，该文章提出了一种基于消息评价的信誉计算方法。文献[9]中的车辆信誉受车辆间数据信息交易结果的影响，对于每一台车辆维护一个朴素贝叶斯网络，在其叶节点中更新该车辆各个交易身份对应的不同信誉值。

### 1.3 论文的研究内容及贡献（及组织结构）

本文设计了一套车载自组网中车辆信誉评估的算法，并实现了该算法的原型系统。

（1）基于车辆的行驶状态和车辆在网络中的交互，提出一套信誉评估算法，使得车辆的可信度能够得到较为全面、真实的反映；

（2）使用以太坊区块链，实现了该算法的原型系统，对车辆位置验证、消息传播等互动行为进行模拟，并展现车辆在行驶过程中信誉的实时更新；

（3）利用原型系统进行模拟与实际数据的测试，分析并评估了参数选取对算法稳定性、科学性的影响。



## 2 车辆信誉管理系统的设计

### 2.1 整体架构

#### 2.1.1 信誉值影响因素

车辆在行驶过程中携带了大量信息，如何筛选这些信息、保留对于车辆信誉最具有代表性的关键因素是设计该算法的第一个问题。考虑到车辆信誉值本质上是其他车辆用于决定是否信任该车辆的判断指标，车辆在自组网中参与的信息交互结果应当是信誉评估的主要影响因子。而一辆车自身的行驶状态，譬如行驶速度、运动轨迹、驾驶员操作等信息，尽管可以对信誉判断起到辅助作用，但是不属于展现该车对邻近车辆是否可信的主要参考指标，通常也无法直接地反映其信誉；因此，为了保证算法的简洁性，这类因素不属于笔者进行算法设计时的考量目标。

本文提出的车辆信誉算法主要受到以下几个因素的影响：

1. 用户活跃度。车辆上传有效数据、更新状态的频率越高，其对应的信誉增益就更加明显，这代表它在车载网中积极地进行信息交互，并且共享的信息频繁地得到了其他车辆的确认。如果车辆很少在网络中与其他车辆进行任何互动，那么极其稀疏的数据提交对其信誉增长的帮助将是非常有限的：一方面是由于车辆的信誉同样具有时效性，在计算时需要保证信誉值能准确地体现车辆当前的可信程度，用户长时间的沉寂会使其历史信誉不再具有足够的效力；另一方面可以防止恶意车辆用户和少量的同谋伪造有效信息，仅通过少量的数据提交就能获得很好的信誉评价。
2. 车辆交互的结果。这是本文算法进行信誉评估的主要计算依据，因为车辆之间进行信息交互的结果、邻近车辆对于信息的评价是直接体现车辆可信度的指标。其中，车辆的交互方式主要包括：
   1. 位置验证。车载网在应用中包含众多基于位置的服务，因此位置验证是车辆行驶过程中进行得较为频繁的一项例行交互行为。车辆通过短距离通信向邻近车辆发送请求，表示自己希望得到位置验证，然后邻近车辆根据自身的定位信息和请求者提供的地理位置，返回经过自己确认的验证结果，可以视为一次成功的位置验证。成功的位置验证可以确认车辆提供的地理位置信息的准确性，以及在对应的信息交换过程中的诚实行为，从而得到信誉值的提升；相反，位置验证失败可能意味着车辆自身定位不够准确、车辆故意捏造虚假的位置信息等状况，但无论如何，验证失败都代表车辆提供的信息对于网络中的其他用户来说是不够可信的，因此其信誉值会相应减少。
   2. 消息传播。车辆之间传播的消息，譬如路况提示、事故告警等，其发生频率低于位置验证，但同样是衡量车辆可信度的重要指标。车辆的信誉由其发送消息的质量（准确性、及时性）体现，每条消息的质量通过其他收到消息的车辆对其给出的评价来确定，而周围车辆给出的评价是否客观准确，则和它与消息发送者之间的距离相关。
3. 监督与举报。上述车辆交互通常限于两辆车之间，但是为了防止恶意信息的伪造和传播，车辆信誉评估的系统同样鼓励第三方对交互内容的监督和举报。不论是位置验证还是消息传播，相关数据都将在车载网内部进行传播，收到信息的第三方车辆可以对其内容进行检查，并举报虚假信息的存在。由于这一行为需要用户额外的计算开销，因此举报成功可以获得相应的信誉值奖励，同时被举报的恶意用户将受到严厉的惩罚。

#### 2.1.2 系统构成

算法基于车辆交互的结果，针对单个车辆的信誉进行计算；使用路侧单元（RSU）作为主要的计算实体，同时目标车辆周边的邻近车辆在消息评价等环节进行辅助的评估。在实际应用中，RSU使用区块链结构进行信誉维护，使得信誉评估的过程得到安全性的保障。在目标车辆完成一次与邻近车辆的交互后（如进行一次位置验证，或发送一条消息），交互结果被上传到RSU，并根据本章提出的算法进行信誉偏移值的计算，并更新目标车辆的信誉值。

### 2.2 信誉计算方式

本节将介绍车辆信誉算法涉及到的具体公式。将目标车辆的信誉值记为$T$，$T$是在$[0,100]$范围内的整数。在目标车辆作为新用户加入到车载网中时，它被赋予初始信誉值$T_0$。每次进行位置验证或消息传播后，车辆间交互的结果将被用于计算目标车辆新的信誉值$T'$。下面介绍信誉值更新的具体算法。

#### 2.2.1 时间衰减系数

目标车辆基于一次交互更新的信誉值为：
$$
T'=T+\Delta T*D(t)公式(2-1)
$$
其中$T$为本次信誉计算前车辆的原始信誉值，$\Delta T$为根据本次交互结果计算得到的信誉偏移值，$D(t)$表示基于数据提交时间间隔得到的时间衰减系数，其计算方法如下：
$$
D(t)=\frac{1}{\delta*(t-t_l)}公式(2-2)
$$

其中$\delta$为参数，t表示本次提交数据的时间，t_l表示上一次提交数据的时间。通过公式（2-2）引入时间衰减系数，目的在于以数据提交时间间隔对用户活跃度进行量化。在公式（2-1）中将信誉偏移值与时间衰减系数进行叠加，使得活跃度这一指标在信誉调整的幅度上能够得到明确的体现，而同时避免了交互结果对信誉的影响被完全覆盖：成功的交互必然能导致信誉提升，失败的交互必然能导致信誉下降，但是交互的频率作用于信誉的增减幅度，长时间不提交数据会导致一次交互结果对信誉值的总影响减弱。

#### 2.2.2 基于位置验证的信誉计算

在目标车辆进行一次位置验证之后，其信誉偏移值的计算方式如下：
$$
\Delta T=\left\{\begin{array}{l}
max(\theta_{s}*(sRate+1)+\theta_{f}*fRate,0) & & 本次验证成功\\
min(\theta_{s}*sRate+\theta_{f}*(fRate+1),0) & & 本次验证失败\\
\end{array} \right. \\
公式(2-3)
$$
其中sRate、fRate分别表示目标车辆在近期一段行驶历史中位置验证的成功率和失败率。该公式保证了本次验证结果对信誉偏移方向的决定性影响：本次验证成功必然使信誉提升，本次验证失败必然使信誉下降。除了对当次位置验证结果进行考量之外，公式（2-3）还引入了历史记录中的验证结果，在保证本次验证占有最大权重的同时对信誉偏移的计算结果进行平滑处理。

#### 2.2.3 基于消息传播的信誉计算

在目标车辆i向周围车辆发送一条消息m之后，收到这条消息的邻近车辆j将根据消息内容的准确性对其进行打分，分数$R_j^m$为[1,10]之间的整数。在汇总了所有周围车辆对消息m的打分之后，可计算其总评价：
$$
Cred_m=\frac{\sum_jw_{ij}*R_j^m}{\sum_jw_{ij}}公式（2-4）
$$
其中权重$w_{ij}$由车辆$i$、$j$的距离$dis(i,j)$决定：
$$
w_{ij}=e^{-\gamma* dis(i,j)}公式（2-5）
$$

在公式（2-4）中，对邻近车辆的打分进行加权的意义在于，邻近车辆对消息内容的评价应当基于自己对实际情况的观察，因此其评价与自身和消息相关事件之间的距离也有一定关系。考虑到这条消息描述的是目标车辆所处位置的事件，故可用目标车辆和邻近车辆之间的距离表示消息描述事件和消息评价者之间的距离。从公式（2-5）中可以看出，两辆车距离越近，对应的消息打分所占权重越高，代表该邻居车辆对事件的观察、对消息的评价更具有说服力。

在计算得到消息m的总评价后，可根据Cred_m判定消息是否可信，从而计算相应的信誉偏移值：
$$
\Delta T=\left\{\begin{array}{l}
Reward=\alpha*D*\frac{1}{e^L}       &      & {消息可信}\\
Punishment=(-1)*\beta*D*\frac{1}{e^L}     &      & {消息不可信}\\
\end{array} \right.\\
公式(2-6)
$$
其中D表示车辆密度，L表示消息的紧急级别（$L=1$：事故警告；$L=2$：路况提示）。可以看到，车辆密度越大、消息内容越紧急，计算得到的信誉偏移幅度就越大，因为有更多的车辆受到了这条消息的影响。

### 2.4 安全性分析（科学性分析？）

当车辆在道路上正常行驶，并能够持续、稳定地与周围车辆完成交互时，该算法显然能保证目标车辆信誉值的稳步上升；然而实际应用中，可能会遇到各种特殊情况，不论是否是人为制造，都会导致车辆交互失败并使其信誉值下降。本节将针对一些可能出现的意外情况进行具体讨论，分析上文提出的算法是否能在这些情况下合理、公正地体现车辆信誉的变化。

1. 客观原因导致交互失败。目标车辆可能由于自身设备出现故障等原因，导致无法获取准确的地理位置信息，或者中断与其他车辆的通讯，进而导致信誉值的下降。这种情况的出现，并不违背本文算法设计的前提：车辆信誉值是为其他车辆提供的、用于判断该车辆提供信息是否可信的评价指标，即使是由于客观原因导致的交互失败，也意味着目标车辆当前的状况并不适合与其他车辆共享信息。对于个别偶然的失败情况来说，本文算法引入了历史记录进行偏移值的平滑，这使得拥有良好交互记录的车辆不会大幅损失信誉值；如果在一段时间内存在持续的失败交互，车辆的信誉值将降低至不可信水平，但是如果影响车辆的客观因素消失，其信誉值还能够通过之后的正常活动重新回升。
2. 恶意诋毁。道路上可能存在一些恶意的车辆，在作为邻近车辆参与交互时故意给予负面的反馈，譬如声称其他车辆位置验证请求中的地理信息不合法，或者故意给其他车辆发出的消息打出低分。本文算法没有为了避免这种情况而进行专门的设计，但是可以看到当这种恶意车辆在整体交通中仅占少数部分时，它们的诋毁行为不会对诚实车辆的信誉产生明显的影响。对于位置验证，考虑到历史验证成功率对整体结果的平滑，个别的验证失败结果对车辆可信度影响不大。对于消息传播，消息总评价由多车打分的加权平均得到，并且最终只通过消息是否可信来判定信誉值增减，而不考虑可信范围内具体的分数高低。因此，少数的恶意负面评价通常也很难影响最后的整体结果。
3. 多人合谋：车载网系统中还可能面临的一种安全威胁，是多台恶意车辆之间的合谋，例如一台恶意车辆可以发送包含虚假位置信息的位置验证请求，而其合谋者为其提供捏造的确认信息，两者通过这种形式完成了一次成功的位置验证并获得了信誉值的提升，尽管验证的信息实际上并不合法。对于本文提出的算法来说，这种形式的攻击仅当与之合谋的车辆足够多时才能够收获明显的效果。这是因为区块链上维护了一段时间内的车辆交互结果记录，而同一对车辆在这段时间内不能反复地进行同样的交互。如果其他车辆能够正常地识别恶意车辆信息的异常，那么这种合谋行为也难以有效地提升其信誉值，除非周围的车辆都是与之串通的共犯；但是在实际情况中，这样做的伪造成本会变得极其高昂，再考虑到车辆的流动，其可行性也是较低的。

### 2.5 本章小结

本章介绍了对车辆信誉进行计算时所考量的因素以及具体的计算公式，并通过一些可能出现的实际情况分析了算法的合理性与科学性。信誉算法主要基于车辆之间交互的结果，包括位置验证和消息传播两部分，进行信誉值的更新，同时引入了时间衰减系数，根据活跃度调整信誉增减的幅度。对于可能的意外故障或潜在的恶意攻击，该算法都能较好地通过信誉值反映车辆当前的实际状况。



## 3 信誉评估算法原型系统的实现

### 3.1 总体框架及运行环境

信誉评估算法的原型系统框架主要分为两个部分：浏览器端及智能合约端。浏览器端模拟实际场景中的车辆终端，进行位置信息获取、车辆交互等数据处理任务；智能合约端模拟实际场景中的路侧单元（RSU），对车辆的信誉进行更新和维护。考虑到智能合约对于复杂运算存在较大的限制，同时区块链上的大量计算需要付出相应的执行费用，因此该原型系统中位置验证、消息传播的模拟由浏览器端负责，将模拟的交互结果上传至区块链后，合约端仅负责信誉值的评估计算。本原型系统的运行流程如下：

1. 系统初始化。浏览器端通过web3.js接口对信誉评估的智能合约进行初始化，同时加载地图和车辆行驶的道路数据，转化为Geohash格式存储，便于之后的合约计算。结合加载的缓存数据，为目标车辆生成用户的通用唯一识别码，作为该车辆身份的确认证明，此后浏览器端将对该目标车辆的行驶路线和信誉值变化进行追踪。
2. 模拟车辆交互。车辆交互结果的模拟是浏览器端的重要部分，该步骤中程序对目标车辆和其行驶途中遇到的邻近车辆分别进行位置验证和消息传播的模拟，并最终给出模拟交互的结果。具体实现方式见3.2节。
3. 上传交互结果。获得交互结果（位置验证结果或者邻近车辆给出的消息评价）之后，浏览器端利用web3.js接口将该结果的相关数据打包上传至区块链，在合约端进行结果数据的存储，并进行信誉值计算。
4. 信誉评估。信誉评估是合约端程序的主要内容，依据模拟交互的结果、数据上传的时间及上一章中设计的算法进行信誉值的计算和更新。针对智能合约在计算开销方面的限制，笔者在信誉评估合约中采取了一系列简化计算的措施，具体情况见3.3节。
5. 地图展示。浏览器端使用了leaflet（一个开源的JavaScript互动地图库，适用于移动设备）进行地图及车辆行驶路线的展示。在合约端完成信誉值的更新之后，浏览器端可以通过web3.js接口获取更新之后的信誉值，该信誉值及本次车辆交互的结果都可以在leaflet地图中得到可视化展示，具体情况见3.4节。

运行环境

### 3.2 车辆交互模拟

该原型系统中，浏览器端负责车辆交互的模拟，其中包括位置验证的模拟和消息传播的模拟。对于位置验证，每次模拟只涉及到目标车辆和一台邻近车辆；对于消息传播，每次交互（即同一条消息的发送与评价）涉及到目标车辆及其周围的多方车辆。在程序中两种场景的模拟独立进行，分别选取对应的参与车辆并各自进行交互的模拟，两者的结果互不影响。下面，文章将分别介绍两种交互的具体模拟形式。

#### 3.2.1 位置验证模拟

在目标车辆行驶过程中，它可以向一定范围内的邻近车辆发送希望获得位置验证的请求，当一辆邻近车辆收到该请求后，可以视为两辆车进行了一次位置验证的交互，而最终是否获取有效的位置验证即为本次交互结果成功或失败的判断标准。在实际情况中，位置验证是否成功可能取决于以下因素：参与交互的车辆对当前行驶区域的熟悉程度；交互车辆获取地理位置信息的准确度；交互车辆之间的通讯信号强度；交互车辆中是否存在恶意行为。

在本文所实现的原型系统中，对位置验证过程中通信的具体内容不做过多考虑，仅通过上述影响因素模拟位置验证的结果，具体思路如下：

1. 对于目标车辆当前所处区域（在该原型系统中，区域按照具体的城市道路进行划分），根据目标车辆行驶的历史数据，每个区域拥有一个对应的位置验证成功率范围。目标车辆经常行驶的区域，对应的验证成功率范围相对更高；对于不够熟悉或者未曾到访过的区域，对应的验证成功率范围相对较低。
2. 目标车辆与邻近车辆进行一次位置验证交互时，其成功率在上述成功率范围之内波动，并最终由两辆车之间的交互距离所确定。其中，交互距离为两辆车在各自行驶途中所能达到的最短距离，该距离与位置验证的成功率成一次负相关关系。
3. 在确定了当次位置验证的成功率之后，程序通过伪随机数模拟得到最终的位置验证结果为成功还是失败，并将该结果及相关数据上传至合约端。
4. 特别地，在参数测试与评估阶段，为了对算法中各参数取值在不同环境下的表现进行统一的表现，部分参数测试中略去了行驶道路和交互距离对验证成功率的影响，仅通过伪随机数模拟来观察在确定的验证成功率条件下不同参数取值对系统的影响。

#### 3.2.2 消息传播模拟

在特定事件（比如道路拥堵、交通事故等）发生时，目标车辆可以向邻近车辆发送消息，告知自己观察到的事件信息。由于特殊事件的发生属于偶然情况，因此消息传播这一交互行为的频率相对较小，并且每次仅对一定范围内的特定车辆群体有效。邻近车辆对消息内容的评价和自身与实际事件发生位置之间的距离相关，在本系统中使用该车辆与目标车辆之间的距离进行替代。

与位置验证类似，在程序实现中笔者同样忽略具体的事件及消息内容，主要对接收消息的车辆群体及它们给出的消息反馈进行模拟，主要流程如下：

1. 确定接收消息的邻近车辆。以目标车辆为中心，取与之相距在五个单位之内的所有车辆，为接收到本次交互消息并给出评价的车辆群体。在模拟测试中，周边车辆沿道路呈区域性的均匀分布（车辆密度不同）；在实际测试中，周边车辆的分布则完全由真实数据决定。
2. 模拟邻近车辆的消息评价。每台收到消息的车辆给出对消息的打分，分数是[1,10]之间的整数。在参数测试阶段，为了对距离衰减系数$\gamma$的取值进行评估，并对消息总评价进行可信区域划分，该部分选取了几种消息评价的分布情况，分别进行模拟：评价分数在[1,10]之间完全随机；评价分数较为统一（一致在5分以上或一致在5分以下）；与目标车辆距离较近的中心车辆给出的分数和边缘车辆相差较大（中心车辆评价大于5分、边缘车辆评价小于5分，或者相反情况）。
3. 在浏览器端收集各邻近车辆给出的消息评分，并预先计算每辆车与目标车辆之间的距离，保证评分与交互距离一一对应，并将数据打包上传至合约端。

### 3.3 信誉评估智能合约

智能合约中实现了第2章中的信誉评估算法，并进行相关数据的存储，在实际应用中对应路侧单元（RSU）的功能。由于合约部署在区块链上，具有公开透明、可追溯等特点，因此为信誉计算提供了安全性的保障，从底层结构上确保这一过程是具有权威性的，避免了对信誉值可能的篡改行为。

在本文实现的合约中，以用户为单位进行数据的维护，通过通用唯一识别码（UUID）与用户信息的数据结构user建立映射。在用户信息中，主要维护的数据内容包括历史数据提交时间、位置验证的历史结果统计、用户信誉值等。除此之外，合约中还实现了message数据结构，用于消息传播发生时的信誉计算，其中维护消息发送者UUID、各车辆给出的消息评分、各车辆与消息发送者之间的距离等。

当且仅当目标车辆与邻近车辆完成一次交互模拟之后，浏览器端会上传相应的数据并调用合约中信誉计算的相关接口；合约端则根据交互类型，选择进行位置验证或消息传播结果的数据处理，并进一步完成信誉值的更新。

由于智能合约端的每次计算都会消耗一定的gas（执行开销），同时对内存访问和复杂的数学函数都具有一定的限制，因此合约实现的难点之一就在于在原有算法的基础上对合约计算进行尽可能的简化，采用的具体措施包括：

1. 使用Geohash存储地理位置信息。Geohash是一种地理编码系统，它将传统的经纬度位置信息转换为一维的字符串，每个字符串对应一块矩形的地理区域[10]。使用这种方式存储位置信息，可以在精度允许的范围内对车辆进行定位，同时将与距离相关的计算过程和结果全部转移到整数范畴中，相比于利用经纬度计算得到了大幅度的精简。
2. 在浏览器端进行数据预处理。为了节省合约端的计算开销，部分不与信誉值直接相关的数据可以在浏览器端提前进行计算，比如消息传播过程中各车与目标车辆之间的距离，而在合约端只保留信誉计算的核心步骤。
3. 简化参数相关的计算过程。对于合约端较为复杂的计算步骤，可以事先计算出中间结果，将中间结果作为实际计算的参数。譬如消息传播中涉及到的指数计算，由于系统实现中$dis(i,j)$的实际取值仅限于[0,5]之间的整数，因此在参数$\gamma$确定后可直接计算得到几种可能的幂值并将其作为参数写入程序中，在信誉计算的过程中根据距离直接获取相应的中间值即可。

### 3.4 数据可视化展示

在浏览器端，本文实现的系统使用了leaflet地图组件进行车辆行驶的可视化展示。展示的具体效果可参考第四章中的图片。在地图中，红色、绿色的点共同构成了目标车辆的行驶轨迹，利用转换为Geohash的地理数据进行绘制；每个数据点具体的颜色代表了目标车辆行驶至该位置时的信誉值，红色（#FF0000）代表信誉值为0,，绿色（#00FF00）代表信誉值为100，在该范围内进行颜色的梯度渐变。

除此之外，邻近车辆与目标车辆的交互结果也被展示在地图中。为了保证目标车辆的轨迹和信誉变化能得到清晰的体现，在地图中仅标注邻近车辆与目标车辆距离最近时该车所处的位置；此时两车之间的距离即为前文提到的计算所采用的交互距离。车辆交互的结果同样用颜色来表示：交互成功（位置验证成功，或者消息评价在5分以上）的邻近车辆被标记为蓝色，交互失败的车辆被标记为紫色。

通过系统中的地图展示，可以清晰明了地看到目标车辆在行驶途中与邻近车辆产生的交互位置、交互结果，以及由此得到的信誉值变化。

### 3.5 本章小结

本章介绍了车辆信誉评估算法原型系统的具体实现。该系统在浏览器端进行车辆交互的结果模拟以及行驶状态的可视化展示，在合约端进行信誉值的更新，通过区块链保证了信誉计算的安全性。



## 4 测试与评估

考虑拆成两章：模拟测试+实际数据测试，或者参数调整+参数确定后测试结果（包括模拟和实测）

### 4.1 模拟测试

#### 4.1.1 测试方法

行驶路线：田字格

车辆分布：密集/稀疏，均匀分布/路口处密集分布

#### 4.1.2 参数设计与分析

（参考测试文档）

##### 4.1.2.1 时间衰减系数

##### 4.1.2.2 基于位置验证的信誉计算参数

##### 4.1.2.3 基于消息传播的信誉计算参数

#### 4.1.3 综合模拟测试结果

参数确定后，整合各部分，生成完整的地图和曲线

根据具体情况进行一定的分析

### 4.2 实际数据测试

#### 4.2.1 数据处理

数据来源、筛选及处理方法

#### 4.2.2 测试结果

地图和信誉曲线

根据具体情况进行一定的分析

### 4.3 评估与讨论（分析与改进？）

总结模拟测试、实际数据测试的结果，分析系统对车辆信誉变化的反应是否忠于测试中对应的情况，该系统对车辆信誉的体现在实际场景中是否具有足够的科学性和代表性。提出可能的改进方向。

### 4.4 本章小结



## 5 结论





## 参考文献

[1] Using Blockchain for Peer-to-Peer Proof-of-Location

[2] C. Javali, G. Revadigar, K. B. Rasmussen, W. Hu, and S. Jha. I am alice, i was in wonderland: Secure location proof generation and verification protocol. In 2016 IEEE 41st Conference on Local Computer Networks (LCN), pages 477–485, Nov 2016.

[3] Y. Li, L. Zhou, H. Zhu, and L. Sun. Privacy-preserving location proof for securing largescale database-dri

[4] Zhichao Zhu and Guohong Cao. Toward privacy preserving and collusion resistance in a location proof updating system. IEEE Transactions on Mobile Computing, 12(1):51–64, January 2013

[5] ] Q. Li, A. Malip, K. M. Martin, S. Ng, and J. Zhang, “A reputation-based announcement scheme for VANETs,” IEEE Transactions on Vehicular Technology, vol. 61, no. 9, pp. 4095-4108, Nov. 2012.

[6] M. Raya, P. Papadimitratos, V. D. Gligor, and J. P. Hubaux, “On datacentric trust establishment in ephemeral ad hoc networks,” in Proc. IEEE INFOCOM, Phoenix, USA, Apr. 2008, pp. 1238-1246

[7]  X. Huang, R. Yu, J. Kang, and Y. Zhang, “Distributed reputation management for secure and efficient vehicular edge computing and networks,” IEEE Access, vol. 5, pp. 25408-25420, Dec. 2017.

[8] Blockchain-based Decentralized Trust Management in Vehicular Networks

[9] Light-weight Blockchain Architecture for V2V Knowledge Sharing at Vehicular Edges

[10] 基于区块链和手机传感器的 车辆位置验证