# 信誉值计算方案

## 考虑因素

- 新注册用户
- 数据更新频率
  - 稳定的参与
  - 具体活跃程度
- 行驶速度？
- 是否为已知联络人
- 来自邻居的位置验证
  - 请求/响应的地理位置在设定范围之外
  - 请求/响应的地理位置在附近，但不能由短距离通信联系到

- 与其它车辆达成的交易
  - 交易方/签署方
- 数据、消息传播（辅助，因为数据信息交换相对稀疏，并且用于信誉计算可能延迟较大）
  - 消息的原创性/冲突
    - 冲突消息：冲突是客观原因导致的不同；伪造是主观原因导致的不同，错误的收益方是自己
    - 抄袭：伪造信息来源
  - 车辆与事件之间的距离
  - 接收信号强度（RSS）
  - 接收到消息的车辆数量（受了该消息影响的邻居规模）
- 对欺骗行为的举报



## 需要防范的攻击

- Prover使用自己的位置信息和另一人的身份信息发送请求
- 邻居为Prover生成虚假的位置验证/交易成功信息
- 邻居为Prover生成恶意的位置验证/交易失败信息



## 计算

- 信誉值范围：0-100的整数，高于某个阈值$T$则被判定为可信的
- 新注册用户的初始信誉值为$T_0$，$T_0<T$？
- 数据长时间不更新的，信誉值减小，采用分段函数？两种方案：
  - 检查最后两次提交的时间间隔
  - 检查最后两次提交的区块间隔
  - 稳定、持续地高活跃度可适当增加信誉（奖励要明显小于恶意行为可能导致的惩罚）
- 成功/失败的位置验证对信誉值影响
  - 两者加权，计算一个信誉值的偏移量，加到原信誉值上。
  - 比如：$\Delta=\theta_1*(success-s_0)+\theta_2*failure$
    - 用户完成了一定数量的成功位置验证信誉值才会增加，防止合谋
    - 验证失败必然会降低可信度
  - 后续可以考虑区分请求者和邻居身份的信誉值
    - 两种身份的偏移量计算公式与上面类似，各取不同的参数
    - 区别错误信息，看位置验证失败是哪一方的问题
    - 也可以把这两个（加权）平均一下，相当于成功的位置验证同时影响双方信誉
- 成功交易
  - 涉及到实际交易，相应的信誉奖励可以相对更大
  - 与交易数额、交易类型相关
- 消息传播
  - 报告行驶状态、交通状况（周期性）
    - 结合位置验证、多车消息汇总情况（和道路修正？）判断其真实度、准确性
  - 对突发事件的响应和警告（一次性）
    - 由多车消息汇总情况判断其真实度、准确性
    - 可设定响应级别，信誉奖励/惩罚与级别正相关
  - 消息真实度决定信誉增加还是减少；可以考虑再加入具体量化的准确性
    - 邻居的距离帮助判定消息真实度
  - 信誉偏移量与车流密度正相关，（可选）与发送时间负相关（越早发出信誉偏移量越大）
  - 奖励与惩罚分别设置系数
- 举报恶意行为（偶尔）
  - 对于位置验证、交易、消息中的欺骗行为，统一通过发送消息进行举报？
  - 如何认定举报是合理的？？
    - 被多人举报可认定为恶意（对于部分位置验证、交易可能无法实现）
    - 公职机构/投票，可以事后判断（评价体系）
    - 鼓励无关的第三方进行举报
  - 成功举报使信誉增加；恶意的举报使信誉减少
- 邻居对消息的评价

**信誉计算实体：合约（主要的计算实体）、用户参与（辅助参与者）**



## 公式

### 初始值

$T_0$：小于可信阈值

### 更新时间

- 长时间不更新
  $$
  \Delta T = \left\{
  \begin{array}{rc1}
  
  -0.5t & &{5\leq t<10}\\
  -t+5 & &{10\leq t<30}\\
  -1.5t+20 & &{t\geq30}
  
  \end{array}
  \right.
  $$
  $t$为最后两次提交数据时间间隔，单位为分钟。

### 位置验证

作为位置验证发出者（Verifier）的信誉偏移：
$$
\Delta T_{\rm V}=\theta_{v1}*(success-s_v)+\theta_{v2}*failure
$$
作为提供位置验证邻居（Neighbour）的信誉偏移：
$$
\Delta T_{\rm N}=\theta_{n1}*(success-s_n)+\theta_{n2}*failure
$$
其中$success$、$failure$分别为成功、失败地收到或给出的位置验证。

总信誉值：
$$
T=w_{\rm V}*T_{\rm V}+w_{\rm N}*T_{\rm N}
$$

### 消息

- 可信度与邻居评价

  邻居$j$可对其收到的、来自车辆$i$的消息$m$进行打分$R_j^m$。消息$m$的整体可信度为：
  $$
  Cred_m=\sum_jw_{ij}*R_j^m
  $$
  其中权重$w_{ij}$由车辆$i$、$j$的距离$dis(i,j)$决定：
  $$
  w_{ij}=e^{-\gamma* dis(i,j)}
  $$
  

  当$Cred_m\ge C_0$时消息$m$被判定为可信。

- 消息发送者的信誉

  车流密度为$D$，消息级别为$L$（$L=1$：事故警告；$L=2$：路况提示；$L=3$：周期性报告）

  判断消息是否可信后，决定信誉值增加或减少：
  $$
  Reward=\alpha*D*\frac{1}{e^L}\\
  Punishment=(-1)*\beta*D*\frac{1}{e^L}
  $$

- 举报

  对于被举报者：
  $$
  \Delta T=10*Punishment
  $$
  对于举报者：
  $$
  \Delta T=10*Reward
  $$
  

## 使用

### 位置验证

- 简单：低于可信阈值的不能作为邻居提供位置验证

- 复杂：每条位置验证有自己的可信度，可以是验证双方信誉值的（加权）平均
  - 按阈值划分可信/不可信
- 注意，要让有恶意行为的车辆受到惩罚，但是对偶尔/不得已出现了故障的车辆，信誉值在行为正常时还能再涨回去

### 道路匹配和位置修正

### 路况计算

- 低于可信阈值的数据直接丢弃

